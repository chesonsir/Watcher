# Watcher
autoupload localfiles to net sharefolder and ftp at a fixtime

1.需安装.Net5.0运行环境
2.配置文件为json格式，{}表示一个对象 []表示一个数组 两者可相互嵌套
3.配置文件所有符号为英文符号
4.注册服务命令，以管理员运行cmd，输入sc.exe create 服务名称 binPath= 程序路径，例如sc.exe create MyWatcher binPath= D:\软件\Watcher.WorkerService\Watcher.WorkerService\bin\Release\net5.0\publish\Watcher.WorkerService.exe
5.删除服务指令sc.exe delete 服务名称
6.win+R输入services.msc打开服务，找到你注册的服务，右键属性，打开登录选项卡，选择“此账户”，将服务运行设置为管理员账户，密码是你的登录密码
7.配置解释

{
  "本机名称": "Fep",   
  "语音提示":true,
  "监视进程": [                                           //可设置多个
    {
      "进程名称": "devenv",                              //win7在任务管理器的进程选项卡中可以查看，win10在任务管理器的详细信息选项卡中可以查看
      "告警门限": 5                                      //程序连续n次无响应就发出告警信息 
    }
  ],
  "监视通信": [                                          //可设置多个
    {
      "通信主机名称": "本机",
      "通信主机IP": "127.0.0.1",                         //监测与该ip的通信状态，每秒ping一次
      "告警门限": 5
    }
  ],
  "监视路径": [                                          //可设置多个
    {
      "监视路径地址": "D:\\测试",                        //需要上传的文件的父路径
      "监视路径子文件夹名称格式": "yyyyMMdd",            //需要上传的文件的子路径名称格式，年:yyyy月:MM日:dd时:HH分:mm秒:ss 中间可以有连接符号例如yyyy-MM-dd HH:mm:ss      
      "文件上传路径列表": [                              //可设置多个
        {
          "文件上传地址": "\\\\127.0.0.1\\bili\\测试",   //共享文件夹路径，注意该路径实际上表示的是\\127.0.0.1\bili\测试，\\表示\
          "用户名": "",
          "密码": "",
          "同名文件处理": "覆盖"                         //忽略:有同名文件就不上传,保留:有同名文件就重命名,覆盖:有同名文件就覆盖
        },
        {
          "文件上传地址": "ftp://127.0.0.1/ftp",         //ftp路径,不需要双倍/
          "用户名": "",
          "密码": "",
          "同名文件处理": "覆盖"
        }
      ],
      "定时上传": "09:31:15",                           //暂时只做了定时上传
      "需要压缩": true,
      "上传后删除文件": true,                           //为false的话,后两项就无用了
      "数据保留（天）": 3,
      "时间基准": "创建时间",                           //判断是否要删除文件的时间基准，文件名:如果文件名格式为时间就参考文件名,创建时间:参考文件的创建时间
      "压缩格式": "zip"                                 //zip和rar
    }
  ],
  "消息组播地址": {                                     //发送日志
    "组播IP地址": "228.8.8.8",
    "组播端口": "9000"
  }
}
